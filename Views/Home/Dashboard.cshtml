@model BugTracker.Models.ViewModels.DashboardViewModel
@using BugTracker.Extensions
@using BugTracker.Models.Enums
@using Microsoft.AspNetCore.Identity
@using BugTracker.Services.Interfaces

@inject UserManager<BTUser> UserManager
@inject IBTRolesService RolesService
@inject IBTProjectService ProjectService
@{
    ViewData["Title"] = "Dashboard";
    BTUser user = await UserManager.GetUserAsync(User);
    int companyId = User.Identity.GetCompanyId().Value;
}

@section VendorCSS {
    <link rel="stylesheet" href="~/vendor/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css">
    <link rel="stylesheet" href="~/vendor/jvectormap/jquery-jvectormap-2.0.3.min.css" />
    <link rel="stylesheet" href="~/vendor/morrisjs/morris.min.css" />
    <link rel="stylesheet" href="~/vendor/nestable/jquery-nestable.css" />

}

@*First Row*@
<div class="row clearfix">
    <div class="col-lg-3 col-md-6">
        <a asp-action="AllProjects" asp-controller="Projects" style="text-decoration: none;">
            <div class="card overflowhidden">
                <div class="body text-center bg-info">
                    <div class="p-15 text-light">
                        <h3>@Model.Projects.Where(p => p.EndDate > DateTime.Now).Count()</h3>
                        <span>Active Projects</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
    <div class="col-lg-3 col-md-6">
        <a asp-action="AllTickets" asp-controller="Tickets" style="text-decoration: none;">
            <div class="card overflowhidden">
                <div class="body text-center bg-secondary">
                    <div class="p-15 text-light">
                        <h3>@Model.Tickets.Count</h3>
                        <span>Total Tickets</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
    <div class="col-lg-3 col-md-6">
        <a asp-action="UnassignedTickets" asp-controller="Tickets" style="text-decoration: none;">
            <div class="card overflowhidden">
                <div class="body text-center bg-warning">
                    <div class="p-15 text-light">
                        <h3>@Model.Tickets.Where(t => t.DeveloperUser is null).Count()</h3>
                        <span>Unassigned Tickets</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="card overflowhidden">
            <div class="body text-center bg-dark">
                <div class="p-15 text-light">
                    <h3>@(Model.Projects.Count() + Model.Tickets.Count() + Model.Members.Count())</h3>
                    <span>Active Projects</span>
                </div>
            </div>
        </div>
    </div>
</div>

@*Second Row*@
<div class="row clearfix">
    <div class="col-lg-3 col-md-6">
        <div class="card">
            <div class="header">
                <h2>My Stats</h2>
            </div>
            <div class="body">
                <div class="list-group list-widget">
                    <a asp-controller="App" asp-action="Inbox" class="list-group-item">
                        <span class="badge badge-success">0</span>
                        <i class="bi bi-person-fill"></i>New Users
                    </a>
                    <a href="javascript:void(0);" class="list-group-item">
                        <span class="badge badge-info">364</span>
                        <i class="bi bi-people-fill"></i> Total Users
                    </a>
                    <a href="javascript:void(0);" class="list-group-item">
                        <span class="badge badge-warning">12</span>
                        <i class="bi bi-ticket-perforated"></i> Tickets in Development
                    </a>
                    <a href="javascript:void(0);" class="list-group-item">
                        <span class="badge badge-danger">54</span>
                        <i class="bi bi-code-slash"></i> Total Developers
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="card">
            <div class="header">
                <h2>Company Data</h2>
            </div>
            <div class="body">
                <div class="list-group list-widget">
                    <a asp-controller="App" asp-action="Inbox" class="list-group-item">
                        <span class="badge badge-success">654</span>
                        <i class="bi bi-people-fill"></i>Members
                    </a>
                    <a href="javascript:void(0);" class="list-group-item">
                        <span class="badge badge-info">364</span>
                        <i class="bi bi-folder2-open"></i> Projects
                    </a>
                    <a href="javascript:void(0);" class="list-group-item">
                        <span class="badge badge-warning">12</span>
                        <i class="fa fa-phone text-muted"></i> Tickets
                    </a>
                    <a href="javascript:void(0);" class="list-group-item">
                        <span class="badge badge-danger">54</span>
                        <i class="bi bi-bell-fill"></i> Notifications
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/bundles/jvectormap.bundle.js"></script> <!-- JVectorMap Plugin Js -->
    <script src="~/bundles/morrisscripts.bundle.js"></script> <!-- Morris Plugin Js -->
    <script src="~/bundles/knob.bundle.js"></script> <!-- Jquery Knob-->
    <script src="~/vendor/nestable/jquery.nestable.js"></script> <!-- Jquery Nestable -->

    <script src="~/js/pages/ui/sortable-nestable.js"></script>
    <script src="~/js/index6.js"></script>

}

<div >
            <h1 class="app-page-title">Dashboard</h1>

            @*Admin Dashboard*@
            @if(User.IsInRole(nameof(Roles.Admin)))
            {
                <!--TOP ROW-->
                <!--GENERAL STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllProjects" asp-controller="Projects">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Active Projects</h4>
                                    <div class="stats-figure">@Model.Projects.Where(p => p.StartDate < DateTime.Now && p.EndDate > DateTime.Now).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Total Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="UnassignedTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Unassigned Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Where(t => string.IsNullOrEmpty(t.DeveloperUserId)).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <h4 class="stats-type mb-1">Analytics</h4>
                                <div class="stats-figure">@(Model.Projects.Count() + Model.Tickets.Count() + Model.Members.Count())</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--SECOND ROW-->
                <!--USER STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <div class="row d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">New Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">Total Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                            <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                            <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row d-flex">
                                            <div class="col-12">
                                                <p class="small text-start">Tickets in Development</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2 ">
                                                <h5 class=""><strong>@Model.Tickets.Where(t => t.DeveloperUserId is not null).Count()</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                            <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-7">
                                                <p class="small">Total Developers</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">

                                           
                                            @{
                                                //Counting devs 
                                                List<BTUser> developers = await RolesService.GetUsersInRoleAsync(nameof(Roles.Developer), companyId);

                                                int developerCount = 0;

                                                foreach(BTUser developer in developers)
                                                {
                                                    developerCount++;
                                                }

                                            }

                                                <h5 class=""><strong>@developerCount</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-200" style="height:100%;">
                            <div class="card-body p-3 p-lg-4">
                                    <div class="pb-3">
                                       <h5 class="">Company Data</h5>
                                       <h6 class="">@Model.Company.Name</h6>
                                    </div>
                                <div class="row pt-2 pb-1 d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-8 align-content-start justify-content-start text-start">
                                            <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                        <a href="#">
                                            <p>Members</p>
                                        </a>
                                    </div>
                                    <div class="col-2"> 
                                        <p class="btn-outline-danger">@Model.Members.Count()</p>
                                    </div>
                                </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder2-open" viewBox="0 0 16 16">
                                                  <path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllProjects" asp-controller="Projects">
                                                <p>Projects</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-warning">@Model.Projects.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                              <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                              <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                            </svg>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllTickets" asp-controller="Tickets">
                                                <p>Tickets</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">@Model.Tickets.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                  <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                  <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                  <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a href="# ">
                                                <p>Notifications</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">0</p>
                                        </div>
                                   </div>

                                </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-chart shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Priority Projects</h5>
                            </div> 
                            <div class="app-card-body mt-4  h-100">
                                <div class="chart-container">
                                    <canvas height="220" id="chart-pie"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Project Ticket Percentage</h5>
                            </div> 
                            <div class="app-card-body mt-4 p-0 h-100" style="height: 400%">
                                <div class="chart-container">
                                    <canvas height="250"  id="chart-doughnut"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*<!--THIRD ROW-->
                <!--PROJECTS BY TICKET PRIORITY COUNTS BAR CHART-->
                <div class="row mb-4">
                    <div class="col">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <canvas id="am-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                *@
                <!--FOURTH ROW-->
                <!--Members and Projects Table-->
                <div class="row g-4 mb-4">
                    <div class="col-5">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Members</h5>
                                </div>
                                <div class="table-responsive">
                                    <table id="membersTable" class="table app-table-hover mb-0 text-start">
                                        <thead>
                                            <tr>
                                                <th class="cell">Avatar</th>
                                                <th class="cell">Name</th>
                                                <th class="cell">Projects</th>
                                                <th class="cell">Role</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                    
                                            @for(int i =0; i < Model.Members.Count(); i++)
                                            {     
                                                <tr>
                                                    @if(Model.Members[i].AvatarFileData is null)
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:30px;height:30px;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:60px;height:60px;" src="data:image/*;base64,@(Convert.ToBase64String(Model.Members[i].AvatarFileData))" alt="@Model.Members[i].FullName's avatar'" />
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                        @Model.Members[i].FullName
                                                    </td>

                                                    @if(Model.Members[i].Projects is null)
                                                    {
                                                        <td class="cell">
                                                            0
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            @Model.Members[i].Projects.Count()
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                            @Model.Roles[i]
                                                    </td>

                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-7">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Projects</h5>
                                </div>
                                <div class="table-responsive">
								    <table id="projectsTable" class="table app-table-hover mb-0 text-left">
									    <thead>
										    <tr>
											    <th class="cell">Project</th>
											    <th class="cell">End Date</th>
												
											    <th class="cell">Project Manager</th>
											    <th class="cell">Team</th>
												
											    <th class="cell"></th>
										    </tr>
									    </thead>
									    <tbody>
									    @foreach(Project project in Model.Projects.Where(m => m.Archived == false))
									    {
											
											    <tr>
												    <td class="cell">
													    <span class="">@project.Name</span>
													    <span class="note">Created @project.StartDate.ToString("MM.dd.yy")</span>
												    </td>
												    <td class="cell"><span class="truncate">@project.StartDate.ToString("MM.dd.yy")</span></td>
													
												    <td class="cell">
													    @{
														    var projectManager = await ProjectService.GetProjectManagerAsync(project.Id);
													    }

													    @if (projectManager is not null)
													    {
														    @if (projectManager.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(projectManager.AvatarFileData))" alt="@projectManager.FullName's avatar'" />
														    }
														    <span class="note">@projectManager.FullName</span>
													    }
													    else
													    {
														    <span class="truncate">Not Assigned</span>
													    }
												    </td>
												    <td class="cell">
													    @foreach (BTUser member in project.Members)
													    {

														    @if (member.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(member.AvatarFileData))" alt="@member.FullName's avatar'" />
														    }
													    }
												    </td>
												    <td class="cell text-center">
													    <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Projects" asp-route-id="@project.Id">
														    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
															    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
															    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
														    </svg>
													    </a>
													    @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
													    {
														    <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
																    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
																    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
															    </svg>
														    </a>
														    <a class="btn-sm app-btn-secondary g-2" asp-action="Restore" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
																    <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
																    <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
															    </svg>
														    </a>
													    }
												    </td>
											    </tr>
									    }
									    </tbody>
								    </table>
							    </div>
                            </div>
                        </div>
                    </div>
                </div>

                @*FIFTH ROW*@
                @*Tickets Table*@
                <div class="row mb-1">
                    <div class="col">
                        <div class="app-card app-card-orders-table shadow-sm mb-5">
                            <div class="card-body pt-3 ps-3">
                                <div class="p-2 text-center">
                                    <h4 class="">Tickets</h4>
                                </div>
                                <div class="table-responsive">
                                    <table id="ticketsTable" class="table app-table-hover mb-0 text-left">
                                        <thead>
                                            <tr>
                                                <th class="cell">Title</th>
                                                <th class="cell">Developer</th>
                                                <th class="cell">Status</th>
                                                <th class="cell">Priority</th>
                                                <th class="cell">Date</th>
                                                <th class="cell">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach(Ticket ticket in Model.Tickets)
                                            {     
                                                <tr>
                                                    <td class="cell">@ticket.Title</td>
                                            
                                                    @*DeveloperUser*@
                                                    @if(ticket.DeveloperUserId is not null)
                                                    {
                                                        <td class="cell">@ticket.DeveloperUser.FullName</td>
                                                    }
                                                    else 
                                                    {
                                                        <td class="cell"></td>
                                                    }

                                                    @*TicketStatus*@
                                                    @if(ticket.TicketStatus.Name == "New")
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }

                                                    @*TicketPriority*@
                                                    <td class="cell">@ticket.TicketPriority.Name</td>
                                            
                                                    @*TicketDate*@
                                                    <td class="cell">@ticket.Created.ToString("MM-dd-yyyy")</td>

                                                    @*Actions*@
                                                    <td class="cell text-center">
												        <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Tickets" asp-route-id="@ticket.Id">
													        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
														        <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
														        <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
													        </svg>
												        </a>
												        @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
												        {
													        <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Tickets" asp-route-id="@ticket.Id">
															        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
															        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
															        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
														        </svg>
													        </a>
													        <a class="btn-sm app-btn-secondary g-2" asp-action="Archive" asp-controller="Tickets" asp-route-id="@ticket.Id">
														        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
															        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
															        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
														        </svg>
													        </a>
												        }
											        </td>
                                                </tr>

                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
            
            @*PM Dashboard*@
            @if(User.IsInRole(nameof(Roles.ProjectManager)))
            {
                <!--TOP ROW-->
                <!--GENERAL STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllProjects" asp-controller="Projects">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Active Projects</h4>
                                    <div class="stats-figure">@Model.Projects.Where(p => p.StartDate < DateTime.Now && p.EndDate > DateTime.Now).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Total Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="UnassignedTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Unassigned Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Where(t => string.IsNullOrEmpty(t.DeveloperUserId)).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <h4 class="stats-type mb-1">Analytics</h4>
                                <div class="stats-figure">@(Model.Projects.Count() + Model.Tickets.Count() + Model.Members.Count())</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--SECOND ROW-->
                <!--USER STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <div class="row d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">New Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">Total Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                            <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                            <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row d-flex">
                                            <div class="col-12">
                                                <p class="small text-start">Tickets in Development</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2 ">
                                                <h5 class=""><strong>@Model.Tickets.Where(t => t.DeveloperUserId is not null).Count()</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                            <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-7">
                                                <p class="small">Total Developers</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">

                                           
                                            @{
                                                //Counting devs 
                                                List<BTUser> developers = await RolesService.GetUsersInRoleAsync(nameof(Roles.Developer), companyId);

                                                int developerCount = 0;

                                                foreach(BTUser developer in developers)
                                                {
                                                    developerCount++;
                                                }

                                            }

                                                <h5 class=""><strong>@developerCount</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-200" style="height:100%;">
                            <div class="card-body p-3 p-lg-4">
                                    <div class="pb-3">
                                       <h5 class="">Company Data</h5>
                                       <h6 class="">@Model.Company.Name</h6>
                                    </div>
                                <div class="row pt-2 pb-1 d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-8 align-content-start justify-content-start text-start">
                                            <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                        <a href="#">
                                            <p>Members</p>
                                        </a>
                                    </div>
                                    <div class="col-2"> 
                                        <p class="btn-outline-danger">@Model.Members.Count()</p>
                                    </div>
                                </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder2-open" viewBox="0 0 16 16">
                                                  <path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllProjects" asp-controller="Projects">
                                                <p>Projects</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-warning">@Model.Projects.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                              <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                              <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                            </svg>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllTickets" asp-controller="Tickets">
                                                <p>Tickets</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">@Model.Tickets.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                  <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                  <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                  <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a href="# ">
                                                <p>Notifications</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">0</p>
                                        </div>
                                   </div>

                                </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-chart shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Priority Projects</h5>
                            </div> 
                            <div class="app-card-body mt-4  h-100">
                                <div class="chart-container">
                                    <canvas height="220" id="chart-pie"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Project Ticket Percentage</h5>
                            </div> 
                            <div class="app-card-body mt-4 p-0 h-100" style="height: 400%">
                                <div class="chart-container">
                                    <canvas height="250"  id="chart-doughnut"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*<!--THIRD ROW-->
                <!--PROJECTS BY TICKET PRIORITY COUNTS BAR CHART-->
                <div class="row mb-4">
                    <div class="col">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <canvas id="am-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                *@
                <!--FOURTH ROW-->
                <!--Members and Projects Table-->
                <div class="row g-4 mb-4">
                    <div class="col-5">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Members</h5>
                                </div>
                                <div class="table-responsive">
                                    <table id="membersTable" class="table app-table-hover mb-0 text-start">
                                        <thead>
                                            <tr>
                                                <th class="cell">Avatar</th>
                                                <th class="cell">Name</th>
                                                <th class="cell">Projects</th>
                                                <th class="cell">Role</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                    
                                            @for(int i =0; i < Model.Members.Count(); i++)
                                            {     
                                                <tr>
                                                    @if(Model.Members[i].AvatarFileData is null)
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:30px;height:30px;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:60px;height:60px;" src="data:image/*;base64,@(Convert.ToBase64String(Model.Members[i].AvatarFileData))" alt="@Model.Members[i].FullName's avatar'" />
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                        @Model.Members[i].FullName
                                                    </td>

                                                    @if(Model.Members[i].Projects is null)
                                                    {
                                                        <td class="cell">
                                                            0
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            @Model.Members[i].Projects.Count()
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                            @Model.Roles[i]
                                                    </td>

                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-7">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Projects</h5>
                                </div>
                                <div class="table-responsive">
								    <table id="projectsTable" class="table app-table-hover mb-0 text-left">
									    <thead>
										    <tr>
											    <th class="cell">Project</th>
											    <th class="cell">End Date</th>
												
											    <th class="cell">Project Manager</th>
											    <th class="cell">Team</th>
												
											    <th class="cell"></th>
										    </tr>
									    </thead>
									    <tbody>
									    @foreach(Project project in Model.Projects.Where(m => m.Archived == false))
									    {
											
											    <tr>
												    <td class="cell">
													    <span class="">@project.Name</span>
													    <span class="note">Created @project.StartDate.ToString("MM.dd.yy")</span>
												    </td>
												    <td class="cell"><span class="truncate">@project.StartDate.ToString("MM.dd.yy")</span></td>
													
												    <td class="cell">
													    @{
														    var projectManager = await ProjectService.GetProjectManagerAsync(project.Id);
													    }

													    @if (projectManager is not null)
													    {
														    @if (projectManager.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(projectManager.AvatarFileData))" alt="@projectManager.FullName's avatar'" />
														    }
														    <span class="note">@projectManager.FullName</span>
													    }
													    else
													    {
														    <span class="truncate">Not Assigned</span>
													    }
												    </td>
												    <td class="cell">
													    @foreach (BTUser member in project.Members)
													    {

														    @if (member.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(member.AvatarFileData))" alt="@member.FullName's avatar'" />
														    }
													    }
												    </td>
												    <td class="cell text-center">
													    <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Projects" asp-route-id="@project.Id">
														    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
															    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
															    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
														    </svg>
													    </a>
													    @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
													    {
														    <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
																    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
																    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
															    </svg>
														    </a>
														    <a class="btn-sm app-btn-secondary g-2" asp-action="Restore" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
																    <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
																    <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
															    </svg>
														    </a>
													    }
												    </td>
											    </tr>
									    }
									    </tbody>
								    </table>
							    </div>
                            </div>
                        </div>
                    </div>
                </div>

                @*FIFTH ROW*@
                @*Tickets Table*@
                <div class="row mb-1">
                    <div class="col">
                        <div class="app-card app-card-orders-table shadow-sm mb-5">
                            <div class="card-body pt-3 ps-3">
                                <div class="p-2 text-center">
                                    <h4 class="">Tickets</h4>
                                </div>
                                <div class="table-responsive">
                                    <table id="ticketsTable" class="table app-table-hover mb-0 text-left">
                                        <thead>
                                            <tr>
                                                <th class="cell">Title</th>
                                                <th class="cell">Developer</th>
                                                <th class="cell">Status</th>
                                                <th class="cell">Priority</th>
                                                <th class="cell">Date</th>
                                                <th class="cell">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach(Ticket ticket in Model.Tickets)
                                            {     
                                                <tr>
                                                    <td class="cell">@ticket.Title</td>
                                            
                                                    @*DeveloperUser*@
                                                    @if(ticket.DeveloperUserId is not null)
                                                    {
                                                        <td class="cell">@ticket.DeveloperUser.FullName</td>
                                                    }
                                                    else 
                                                    {
                                                        <td class="cell"></td>
                                                    }

                                                    @*TicketStatus*@
                                                    @if(ticket.TicketStatus.Name == "New")
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }

                                                    @*TicketPriority*@
                                                    <td class="cell">@ticket.TicketPriority.Name</td>
                                            
                                                    @*TicketDate*@
                                                    <td class="cell">@ticket.Created.ToString("MM-dd-yyyy")</td>

                                                    @*Actions*@
                                                    <td class="cell text-center">
												        <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Tickets" asp-route-id="@ticket.Id">
													        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
														        <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
														        <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
													        </svg>
												        </a>
												        @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
												        {
													        <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Tickets" asp-route-id="@ticket.Id">
															        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
															        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
															        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
														        </svg>
													        </a>
													        <a class="btn-sm app-btn-secondary g-2" asp-action="Archive" asp-controller="Tickets" asp-route-id="@ticket.Id">
														        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
															        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
															        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
														        </svg>
													        </a>
												        }
											        </td>
                                                </tr>

                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }

            @*Developer Dashboard*@
            @if(User.IsInRole(nameof(Roles.Developer)))
            {
                <!--TOP ROW-->
                <!--GENERAL STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllProjects" asp-controller="Projects">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Active Projects</h4>
                                    <div class="stats-figure">@Model.Projects.Where(p => p.StartDate < DateTime.Now && p.EndDate > DateTime.Now).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Total Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="UnassignedTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Unassigned Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Where(t => string.IsNullOrEmpty(t.DeveloperUserId)).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <h4 class="stats-type mb-1">Analytics</h4>
                                <div class="stats-figure">@(Model.Projects.Count() + Model.Tickets.Count() + Model.Members.Count())</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--SECOND ROW-->
                <!--USER STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <div class="row d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">New Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">Total Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                            <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                            <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row d-flex">
                                            <div class="col-12">
                                                <p class="small text-start">Tickets in Development</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2 ">
                                                <h5 class=""><strong>@Model.Tickets.Where(t => t.DeveloperUserId is not null).Count()</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                            <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-7">
                                                <p class="small">Total Developers</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">

                                           
                                            @{
                                                //Counting devs 
                                                List<BTUser> developers = await RolesService.GetUsersInRoleAsync(nameof(Roles.Developer), companyId);

                                                int developerCount = 0;

                                                foreach(BTUser developer in developers)
                                                {
                                                    developerCount++;
                                                }

                                            }

                                                <h5 class=""><strong>@developerCount</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-200" style="height:100%;">
                            <div class="card-body p-3 p-lg-4">
                                    <div class="pb-3">
                                       <h5 class="">Company Data</h5>
                                       <h6 class="">@Model.Company.Name</h6>
                                    </div>
                                <div class="row pt-2 pb-1 d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-8 align-content-start justify-content-start text-start">
                                            <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                        <a href="#">
                                            <p>Members</p>
                                        </a>
                                    </div>
                                    <div class="col-2"> 
                                        <p class="btn-outline-danger">@Model.Members.Count()</p>
                                    </div>
                                </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder2-open" viewBox="0 0 16 16">
                                                  <path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllProjects" asp-controller="Projects">
                                                <p>Projects</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-warning">@Model.Projects.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                              <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                              <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                            </svg>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllTickets" asp-controller="Tickets">
                                                <p>Tickets</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">@Model.Tickets.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                  <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                  <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                  <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a href="# ">
                                                <p>Notifications</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">0</p>
                                        </div>
                                   </div>

                                </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-chart shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Priority Projects</h5>
                            </div> 
                            <div class="app-card-body mt-4  h-100">
                                <div class="chart-container">
                                    <canvas height="220" id="chart-pie"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Project Ticket Percentage</h5>
                            </div> 
                            <div class="app-card-body mt-4 p-0 h-100" style="height: 400%">
                                <div class="chart-container">
                                    <canvas height="250"  id="chart-doughnut"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*<!--THIRD ROW-->
                <!--PROJECTS BY TICKET PRIORITY COUNTS BAR CHART-->
                <div class="row mb-4">
                    <div class="col">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <canvas id="am-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                *@
                <!--FOURTH ROW-->
                <!--Members and Projects Table-->
                <div class="row g-4 mb-4">
                    <div class="col-5">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Members</h5>
                                </div>
                                <div class="table-responsive">
                                    <table id="membersTable" class="table app-table-hover mb-0 text-start">
                                        <thead>
                                            <tr>
                                                <th class="cell">Avatar</th>
                                                <th class="cell">Name</th>
                                                <th class="cell">Projects</th>
                                                <th class="cell">Role</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                    
                                            @for(int i =0; i < Model.Members.Count(); i++)
                                            {     
                                                <tr>
                                                    @if(Model.Members[i].AvatarFileData is null)
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:30px;height:30px;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:60px;height:60px;" src="data:image/*;base64,@(Convert.ToBase64String(Model.Members[i].AvatarFileData))" alt="@Model.Members[i].FullName's avatar'" />
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                        @Model.Members[i].FullName
                                                    </td>

                                                    @if(Model.Members[i].Projects is null)
                                                    {
                                                        <td class="cell">
                                                            0
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            @Model.Members[i].Projects.Count()
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                            @Model.Roles[i]
                                                    </td>

                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-7">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Projects</h5>
                                </div>
                                <div class="table-responsive">
								    <table id="projectsTable" class="table app-table-hover mb-0 text-left">
									    <thead>
										    <tr>
											    <th class="cell">Project</th>
											    <th class="cell">End Date</th>
												
											    <th class="cell">Project Manager</th>
											    <th class="cell">Team</th>
												
											    <th class="cell"></th>
										    </tr>
									    </thead>
									    <tbody>
									    @foreach(Project project in Model.Projects.Where(m => m.Archived == false))
									    {
											
											    <tr>
												    <td class="cell">
													    <span class="">@project.Name</span>
													    <span class="note">Created @project.StartDate.ToString("MM.dd.yy")</span>
												    </td>
												    <td class="cell"><span class="truncate">@project.StartDate.ToString("MM.dd.yy")</span></td>
													
												    <td class="cell">
													    @{
														    var projectManager = await ProjectService.GetProjectManagerAsync(project.Id);
													    }

													    @if (projectManager is not null)
													    {
														    @if (projectManager.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(projectManager.AvatarFileData))" alt="@projectManager.FullName's avatar'" />
														    }
														    <span class="note">@projectManager.FullName</span>
													    }
													    else
													    {
														    <span class="truncate">Not Assigned</span>
													    }
												    </td>
												    <td class="cell">
													    @foreach (BTUser member in project.Members)
													    {

														    @if (member.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(member.AvatarFileData))" alt="@member.FullName's avatar'" />
														    }
													    }
												    </td>
												    <td class="cell text-center">
													    <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Projects" asp-route-id="@project.Id">
														    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
															    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
															    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
														    </svg>
													    </a>
													    @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
													    {
														    <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
																    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
																    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
															    </svg>
														    </a>
														    <a class="btn-sm app-btn-secondary g-2" asp-action="Restore" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
																    <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
																    <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
															    </svg>
														    </a>
													    }
												    </td>
											    </tr>
									    }
									    </tbody>
								    </table>
							    </div>
                            </div>
                        </div>
                    </div>
                </div>

                @*FIFTH ROW*@
                @*Tickets Table*@
                <div class="row mb-1">
                    <div class="col">
                        <div class="app-card app-card-orders-table shadow-sm mb-5">
                            <div class="card-body pt-3 ps-3">
                                <div class="p-2 text-center">
                                    <h4 class="">Tickets</h4>
                                </div>
                                <div class="table-responsive">
                                    <table id="ticketsTable" class="table app-table-hover mb-0 text-left">
                                        <thead>
                                            <tr>
                                                <th class="cell">Title</th>
                                                <th class="cell">Developer</th>
                                                <th class="cell">Status</th>
                                                <th class="cell">Priority</th>
                                                <th class="cell">Date</th>
                                                <th class="cell">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach(Ticket ticket in Model.Tickets)
                                            {     
                                                <tr>
                                                    <td class="cell">@ticket.Title</td>
                                            
                                                    @*DeveloperUser*@
                                                    @if(ticket.DeveloperUserId is not null)
                                                    {
                                                        <td class="cell">@ticket.DeveloperUser.FullName</td>
                                                    }
                                                    else 
                                                    {
                                                        <td class="cell"></td>
                                                    }

                                                    @*TicketStatus*@
                                                    @if(ticket.TicketStatus.Name == "New")
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }

                                                    @*TicketPriority*@
                                                    <td class="cell">@ticket.TicketPriority.Name</td>
                                            
                                                    @*TicketDate*@
                                                    <td class="cell">@ticket.Created.ToString("MM-dd-yyyy")</td>

                                                    @*Actions*@
                                                    <td class="cell text-center">
												        <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Tickets" asp-route-id="@ticket.Id">
													        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
														        <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
														        <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
													        </svg>
												        </a>
												        @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
												        {
													        <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Tickets" asp-route-id="@ticket.Id">
															        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
															        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
															        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
														        </svg>
													        </a>
													        <a class="btn-sm app-btn-secondary g-2" asp-action="Archive" asp-controller="Tickets" asp-route-id="@ticket.Id">
														        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
															        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
															        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
														        </svg>
													        </a>
												        }
											        </td>
                                                </tr>

                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }

            @*Submitter Dashboard*@
            @if(User.IsInRole(nameof(Roles.Developer)))
            {
                <!--TOP ROW-->
                <!--GENERAL STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllProjects" asp-controller="Projects">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Active Projects</h4>
                                    <div class="stats-figure">@Model.Projects.Where(p => p.StartDate < DateTime.Now && p.EndDate > DateTime.Now).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="AllTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Total Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <a asp-action="UnassignedTickets" asp-controller="Tickets">
                                <div class="card-body p-3 p-lg-4">
                                    <h4 class="stats-type mb-1">Unassigned Tickets</h4>
                                    <div class="stats-figure">@Model.Tickets.Where(t => string.IsNullOrEmpty(t.DeveloperUserId)).Count()</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <h4 class="stats-type mb-1">Analytics</h4>
                                <div class="stats-figure">@(Model.Projects.Count() + Model.Tickets.Count() + Model.Members.Count())</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--SECOND ROW-->
                <!--USER STATS-->
                <div class="row g-4 mb-4">
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <div class="row d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">New Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                            <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-5">
                                                <p class="small">Total Users</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">
                                                <h5 class=""><strong>0</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                            <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                            <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row d-flex">
                                            <div class="col-12">
                                                <p class="small text-start">Tickets in Development</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2 ">
                                                <h5 class=""><strong>@Model.Tickets.Where(t => t.DeveloperUserId is not null).Count()</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr />

                                <div class="row d-flex">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                            <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"/>
                                        </svg>
                                    </div>
                                    <div class="col-10">
                                        <div class="row">
                                            <div class="col-7">
                                                <p class="small">Total Developers</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-2">

                                           
                                            @{
                                                //Counting devs 
                                                List<BTUser> developers = await RolesService.GetUsersInRoleAsync(nameof(Roles.Developer), companyId);

                                                int developerCount = 0;

                                                foreach(BTUser developer in developers)
                                                {
                                                    developerCount++;
                                                }

                                            }

                                                <h5 class=""><strong>@developerCount</strong></h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-200" style="height:100%;">
                            <div class="card-body p-3 p-lg-4">
                                    <div class="pb-3">
                                       <h5 class="">Company Data</h5>
                                       <h6 class="">@Model.Company.Name</h6>
                                    </div>
                                <div class="row pt-2 pb-1 d-flex">
                                    <div class="col-2">
                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="col-8 align-content-start justify-content-start text-start">
                                            <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                        <a href="#">
                                            <p>Members</p>
                                        </a>
                                    </div>
                                    <div class="col-2"> 
                                        <p class="btn-outline-danger">@Model.Members.Count()</p>
                                    </div>
                                </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder2-open" viewBox="0 0 16 16">
                                                  <path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllProjects" asp-controller="Projects">
                                                <p>Projects</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-warning">@Model.Projects.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                              <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z"/>
                                              <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z"/>
                                            </svg>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a asp-action="AllTickets" asp-controller="Tickets">
                                                <p>Tickets</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">@Model.Tickets.Count()</p>
                                        </div>
                                   </div>

                                   <hr />

                                   <div class="row pt-2 d-flex">
                                        <div class="col-2">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                  <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                  <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                  <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="col-8 align-content-start justify-content-start text-start">
                                             <!--LINK TO LIST OF MEMBERS(needs to be developed)-->
                                            <a href="# ">
                                                <p>Notifications</p>
                                            </a>
                                        </div>
                                        <div class="col-2"> 
                                            <p class="btn-outline-danger">0</p>
                                        </div>
                                   </div>

                                </div>
                        </div>
                    </div>
                    <div class="col-6 col-lg-3">
                        <div class="app-card app-card-chart shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Priority Projects</h5>
                            </div> 
                            <div class="app-card-body mt-4  h-100">
                                <div class="chart-container">
                                    <canvas height="220" id="chart-pie"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="col-6 col-lg-3">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class=" p-4 text-center">
                                    <h5 class="">Project Ticket Percentage</h5>
                            </div> 
                            <div class="app-card-body mt-4 p-0 h-100" style="height: 400%">
                                <div class="chart-container">
                                    <canvas height="250"  id="chart-doughnut"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*<!--THIRD ROW-->
                <!--PROJECTS BY TICKET PRIORITY COUNTS BAR CHART-->
                <div class="row mb-4">
                    <div class="col">
                        <div class="app-card app-card-stat shadow-sm h-100">
                            <div class="card-body p-3 p-lg-4">
                                <canvas id="am-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                *@
                <!--FOURTH ROW-->
                <!--Members and Projects Table-->
                <div class="row g-4 mb-4">
                    <div class="col-5">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Members</h5>
                                </div>
                                <div class="table-responsive">
                                    <table id="membersTable" class="table app-table-hover mb-0 text-start">
                                        <thead>
                                            <tr>
                                                <th class="cell">Avatar</th>
                                                <th class="cell">Name</th>
                                                <th class="cell">Projects</th>
                                                <th class="cell">Role</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                    
                                            @for(int i =0; i < Model.Members.Count(); i++)
                                            {     
                                                <tr>
                                                    @if(Model.Members[i].AvatarFileData is null)
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:30px;height:30px;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            <img class="rounded-circle" style="width:60px;height:60px;" src="data:image/*;base64,@(Convert.ToBase64String(Model.Members[i].AvatarFileData))" alt="@Model.Members[i].FullName's avatar'" />
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                        @Model.Members[i].FullName
                                                    </td>

                                                    @if(Model.Members[i].Projects is null)
                                                    {
                                                        <td class="cell">
                                                            0
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">
                                                            @Model.Members[i].Projects.Count()
                                                        </td>
                                                    }

                                                    <td class="cell">
                                                            @Model.Roles[i]
                                                    </td>

                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-7">
                        <div class="app-card app-card-orders-table  shadow-sm mb-2 h-100">
                            <div class="card-body">
                                <div class="p-2 text-center">
                                    <h5 class="">Projects</h5>
                                </div>
                                <div class="table-responsive">
								    <table id="projectsTable" class="table app-table-hover mb-0 text-left">
									    <thead>
										    <tr>
											    <th class="cell">Project</th>
											    <th class="cell">End Date</th>
												
											    <th class="cell">Project Manager</th>
											    <th class="cell">Team</th>
												
											    <th class="cell"></th>
										    </tr>
									    </thead>
									    <tbody>
									    @foreach(Project project in Model.Projects.Where(m => m.Archived == false))
									    {
											
											    <tr>
												    <td class="cell">
													    <span class="">@project.Name</span>
													    <span class="note">Created @project.StartDate.ToString("MM.dd.yy")</span>
												    </td>
												    <td class="cell"><span class="truncate">@project.StartDate.ToString("MM.dd.yy")</span></td>
													
												    <td class="cell">
													    @{
														    var projectManager = await ProjectService.GetProjectManagerAsync(project.Id);
													    }

													    @if (projectManager is not null)
													    {
														    @if (projectManager.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(projectManager.AvatarFileData))" alt="@projectManager.FullName's avatar'" />
														    }
														    <span class="note">@projectManager.FullName</span>
													    }
													    else
													    {
														    <span class="truncate">Not Assigned</span>
													    }
												    </td>
												    <td class="cell">
													    @foreach (BTUser member in project.Members)
													    {

														    @if (member.AvatarFileData is null)
														    {
															    <img class="rounded-circle shadow-sm" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thin;" src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="Default Avatar"/>
														    }
														    else
														    {
															    <img class="rounded-circle shadow-sm btn-outline-light" style="width:35px;height:35px;margin-left:-15px;outline-color:white;outline-width:thick;" src="data:image/*;base64,@(Convert.ToBase64String(member.AvatarFileData))" alt="@member.FullName's avatar'" />
														    }
													    }
												    </td>
												    <td class="cell text-center">
													    <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Projects" asp-route-id="@project.Id">
														    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
															    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
															    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
														    </svg>
													    </a>
													    @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
													    {
														    <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
																    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
																    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
															    </svg>
														    </a>
														    <a class="btn-sm app-btn-secondary g-2" asp-action="Restore" asp-controller="Projects" asp-route-id="@project.Id">
															    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
																    <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
																    <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
															    </svg>
														    </a>
													    }
												    </td>
											    </tr>
									    }
									    </tbody>
								    </table>
							    </div>
                            </div>
                        </div>
                    </div>
                </div>

                @*FIFTH ROW*@
                @*Tickets Table*@
                <div class="row mb-1">
                    <div class="col">
                        <div class="app-card app-card-orders-table shadow-sm mb-5">
                            <div class="card-body pt-3 ps-3">
                                <div class="p-2 text-center">
                                    <h4 class="">Tickets</h4>
                                </div>
                                <div class="table-responsive">
                                    <table id="ticketsTable" class="table app-table-hover mb-0 text-left">
                                        <thead>
                                            <tr>
                                                <th class="cell">Title</th>
                                                <th class="cell">Developer</th>
                                                <th class="cell">Status</th>
                                                <th class="cell">Priority</th>
                                                <th class="cell">Date</th>
                                                <th class="cell">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach(Ticket ticket in Model.Tickets)
                                            {     
                                                <tr>
                                                    <td class="cell">@ticket.Title</td>
                                            
                                                    @*DeveloperUser*@
                                                    @if(ticket.DeveloperUserId is not null)
                                                    {
                                                        <td class="cell">@ticket.DeveloperUser.FullName</td>
                                                    }
                                                    else 
                                                    {
                                                        <td class="cell"></td>
                                                    }

                                                    @*TicketStatus*@
                                                    @if(ticket.TicketStatus.Name == "New")
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }
                                                    else
                                                    {
                                                        <td class="cell">@ticket.TicketStatus.Name</td>
                                                    }

                                                    @*TicketPriority*@
                                                    <td class="cell">@ticket.TicketPriority.Name</td>
                                            
                                                    @*TicketDate*@
                                                    <td class="cell">@ticket.Created.ToString("MM-dd-yyyy")</td>

                                                    @*Actions*@
                                                    <td class="cell text-center">
												        <a class="btn-sm app-btn-secondary me-2" asp-action="Details" asp-controller="Tickets" asp-route-id="@ticket.Id">
													        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
														        <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
														        <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
													        </svg>
												        </a>
												        @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.Admin)))
												        {
													        <a class="btn-sm app-btn-secondary me-2" asp-action="Edit" asp-controller="Tickets" asp-route-id="@ticket.Id">
															        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
															        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
															        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
														        </svg>
													        </a>
													        <a class="btn-sm app-btn-secondary g-2" asp-action="Archive" asp-controller="Tickets" asp-route-id="@ticket.Id">
														        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
															        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
															        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
														        </svg>
													        </a>
												        }
											        </td>
                                                </tr>

                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }

</div>

